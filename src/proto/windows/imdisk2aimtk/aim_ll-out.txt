>aim_ll
Low-level command line interface to Arsenal Image Mounter virtual
SCSI miniport driver.

For version information, license, copyrights and credits, type aim_ll --version

Setup syntax:
aim_ll --install setup_directory
        Installs Arsenal Image Mounter driver from a directory with setup
        files.

aim_ll --uninstall
        Uninstalls Arsenal Image Mounter driver.

aim_ll --rescan
        Rescans SCSI bus on installed adapter Useful to cleanup virtual disks
        where connection to backend storage service is lost.

Manage virtual disks:
aim_ll -a -t type [-n] [-o opt1[,opt2 ...]] [-f|-F file] [-s size] [-b offset]
       [-S sectorsize] [-u devicenumber] [-m mountpoint]
       [-p "format-parameters"] [-P]
aim_ll -d|-D [-u devicenumber | -m mountpoint] [-P]
aim_ll -R -u unit
aim_ll -l [-u devicenumber | -m mountpoint]
aim_ll -e [-s size] [-o opt1[,opt2 ...]] [-u devicenumber | -m mountpoint]

-a      Attach a virtual disk. This will configure and attach a virtual disk
        with the parameters specified and attach it to the system.

-d      Detach a virtual disk from the system and release all resources.
        Use -D to force removal even if the device is in use.

-R      Emergency removal of hung virtual disks. Should only be used as a last
        resort when a virtual disk has some kind of problem that makes it
        impossible to detach it in a safe way. This could happen for example
        for proxy-type virtual disks sometimes when proxy communication fails.
        Note that this does not attempt to dismount filesystem or lock the
        volume in any way so there is a potential risk of data loss. Use with
        caution!

-e      Edit an existing virtual disk.

        Along with the -s parameter extends the size of an existing virtual
        disk.

        Along with the -o parameter changes media characteristics for an
        existing virtual disk. Options that can be changed on existing virtual
        disks are those specifying wether or not the media of the virtual disk
        should be writable and/or removable.

-t type
        Select the backingstore for the virtual disk.

vm      Storage for this type of virtual disk is allocated from virtual memory
        in the system process. If a file is specified with -f that file is
        is loaded into the memory allocated for the disk image.

file    A file specified with -f file becomes the backingstore for this
        virtual disk.

proxy   The actual backingstore for this type of virtual disk is controlled by
        a storage server accessed by the driver on this machine by
        sending storage I/O requests through a named pipe specified with -f.

-f file or -F file
        Filename to use as backingstore for the file type virtual disk, to
        initialize a vm type virtual disk or name of a named pipe for I/O
        client/server communication for proxy type virtual disks. For proxy
        type virtual disks "file" may be a COM port or a remote server
        address if the -o options includes "ip" or "comm".

        Instead of using -f to specify 'DOS-style' paths, such as
        C:\dir\image.bin or \\server\share\image.bin, you can use -F to
        specify 'NT-style' native paths, such as
        \Device\Harddisk0\Partition1\image.bin. This makes it possible to
        specify files on disks or communication devices that currently have no
        drive letters assigned.

-l      List configured devices. If given with -u or -m, display details about
        that particular device.

-n      When printing listing devices, print only the unit number without other
        information.

-s size
        Size of the virtual disk. Size is number of bytes unless suffixed with
        a b, k, m, g, t, K, M, G or T which denotes number of 512-byte blocks,
        thousand bytes, million bytes, billion bytes, trillion bytes,
        kilobytes, megabytes, gigabytes and terabytes respectively. The suffix
        can also be % to indicate percentage of free physical memory which
        could be useful when creating vm type virtual disks. It is optional to
        specify a size unless the file to use for a file type virtual disk does
        not already exist or when a vm type virtual disk is created without
        specifying an initialization image file using the -f or -F. If size is
        specified when creating a file type virtual disk, the size of the file
        used as backingstore for the virtual disk is adjusted to the new size
        specified with this size option.

        The size can be a negative value to indicate the size of free physical
        memory minus this size. If you e.g. type -400M the size of the virtual
        disk will be the amount of free physical memory minus 400 MB.

-b offset
        Specifies an offset in an image file where the virtual disk begins. All
        offsets of I/O operations on the virtual disk will be relative to this
        offset. This parameter is particularily useful when mounting a specific
        partition in an image file that contains an image of a complete hard
        disk, not just one partition. This parameter has no effect when
        creating a blank vm type virtual disk. When creating a vm type virtual
        disk with a pre-load image file specified with -f or -F parameters, the
        -b parameter specifies an offset in the image file where the image to
        be loaded into the vm type virtual disk begins.

        Specify auto as offset to automatically select offset for a few known
        non-raw disk image file formats. Currently auto-selection is supported
        for Nero .nrg and Microsoft .sdi image files.

-S sectorsize
        Sectorsize to use for the virtual disk device. Default value is 512
        bytes except for CD-ROM/DVD-ROM style devices where 2048 bytes is used
        by default.

-p "format-parameters"
        If -p is specified the 'format' command is invoked to create a
        filesystem when the new virtual disk has been created.
        "format-parameters" must be a parameter string enclosed within
        double-quotes. The string is added to the command line that starts
        'format'. You usually specify something like "/fs:ntfs /q /y", that
        is, create an NTFS filesystem with quick formatting and without user
        interaction.

        If you specify empty format parameters, -p "", a partition is created
        but it is not formatted.

-o option
        Set or reset options.

ro      Creates a read-only virtual disk. For vm type virtual disks, this
        option can only be used if the -f option is also specified.

rw      Specifies that the virtual disk should be read/writable. This is the
        default setting. It can be used with the -e parameter to set an
        existing read-only virtual disk writable.

fksig   If this flag is set, the driver will report a random fake disk
        signature to Windows instead of any existing one, in case the master
        boot record has otherwise apparently valid data.

sparse  Sets NTFS sparse attribute on image file. This has no effect on proxy
        or vm type virtual disks.

rem     Specifies that the device should be created with removable media
        characteristics. This changes the device properties returned by the
        driver to the system. For example, this changes how some filesystems
        cache write operations.

fix     Specifies that the media characteristics of the virtual disk should be
        fixed media, as opposed to removable media specified with the rem
        option. Fixed media is the default setting. The fix option can be used
        with the -e parameter to set an existing removable virtual disk as
        fixed.

saved   Clears the 'image modified' flag from an existing virtual disk. This
        flag is set by the driver when an image is modified and is displayed
        in the -l output for a virtual disk. The 'saved' option is only valid
        with the -e parameter.

        Note that virtual floppy or CD/DVD-ROM drives are always read-only and
        removable devices and that cannot be changed.

cd      Creates a virtual CD-ROM/DVD-ROM.

fd      Creates a virtual floppy disk.

        NOTE: cd and fd options are currently not supported by the driver.

hd      Creates a virtual hard disk. This is the default.

raw     Creates a device object with "controller" device type. The system will
        not attempt to use such devices as a storage device, but it could be
        useful in combination with third-party drivers that can provide further
        device objects using this virtual disk device as a backing store.

ip      Can only be used with proxy-type virtual disks. With this option, the
        user-mode service component is initialized to connect to a
        storage server using TCP/IP. With this option, the -f switch specifies
        the remote host optionally followed by a colon and a port number to
        connect to.

comm    Can only be used with proxy-type virtual disks. With this option, the
        user-mode service component is initialized to connect to a
        storage server through a COM port. With this option, the -f switch
        specifies the COM port to connect to, optionally followed by a colon,
        a space, and then a device settings string with the same syntax as the
        MODE command.

shm     Can only be used with proxy-type virtual disks. With this option, the
        driver communicates with a storage server on the same computer using
        shared memory block to transfer I/O data.

awe     Can only be used with file-type virtual disks. With this option, the
        driver copies contents of image file to physical memory. No changes are
        written to image file. If this option is used in combination with  no
        image file name, a physical memory block will be used without loading
        an image file onto it. In that case, -s parameter is needed to specify
        size of memory block.

bswap   Instructs driver to swap each pair of bytes read from or written to
        image file. Useful when examining images from some embedded systems
        and similar where data is stored in reverse byte order.

        NOTE: This option is currently not supported by the driver.

par     Parallel I/O. Valid for file-type virtual disks. With this flag set,
        driver sends read and write requests for the virtual disk directly down
        to the driver that handles the image file, within the SCSIOP dispatch
        routine. This flag is intended for developers who provide their own
        driver that handles image file requests. Such driver need to handle
        requests at DISPATCH_LEVEL at any time, otherwise system crashes are
        very likely to happen. *Never* use this flag when mounting image files!
        Use it *only* with special purpose drivers that can meet all neeed
        requirements!

buf     Buffered I/O. Valid for file-type virtual disks. With this flag set,
        driver opens image file in buffered I/O mode. This is usually less
        efficient, but it could be required to for example mount an image file
        with smaller sector size than the volume where the image file is
        stored.

-u devicenumber
        Six hexadecimal digits indicating SCSI path, target and lun numbers
        for a device. Format: LLTTPP. Along with -a, request a specific device
        number for the new device instead of automatic allocation. Along with
        -d or -l specifies the unit number of the virtual disk to remove or
        query.

-m mountpoint
        Specifies a drive letter or mount point for the new virtual disk, the
        virtual disk to query or the virtual disk to remove. When creating a
        new virtual disk you can specify #: as mountpoint in which case the
        first unused drive letter is automatically used.

        Note that even if you don't specify -m, Windows normally assigns drive
        letters to new volumes anyway. This behaviour can be changed using the
        MOUNTVOL command line tool.
